<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PARALEL VR</title>
  <style>
    body {
  margin: 0;
  background: #111;
}
html, body {
  height: 300vh; /* ✅ Mantener scroll para animación */
}
canvas {
  display: block;
  position: fixed;
  top: 0;
  left: 0;
}
    
  canvas.webgl-fade {
    transition: opacity 0.8s ease;
  }

#html-wrapper {
  position: relative;
  z-index: 1;          /* Aparece sobre canvas cuando está visible */
}

#html-section {
  display: none;       /* Oculto al inicio */
  background: #fff;
  color: #111;
  padding: 50px;
  text-align: center;
  font-family: Arial, sans-serif;
  min-height: 100vh;   /* Ocupa la pantalla completa */
}
#html-wrapper {
  position: relative;
  z-index: 1;
}

.seo-hero {
  display: none; /* oculto al inicio, JS lo muestra */
  position: relative;
  min-height: 100vh;
  padding: 80px 20px 120px;
  box-sizing: border-box;
  background: #0b0b0b;
  color: #f5f5f5;
  font-family: Arial, sans-serif;

  /* Borde metálico con gradiente */
  border: 4px solid transparent;
  border-radius: 16px;
  background-clip: padding-box;
}
.seo-hero::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 16px;
  padding: 4px;
  background: linear-gradient(135deg, #cfcfcf, #666, #d4d4d4);
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite: destination-out;
  mask-composite: exclude;
  pointer-events: none;
}

/* Logo chico esquina */
.seo-hero-logo {
  position: absolute;
  top: 20px;
  left: 20px;
  max-width: 160px;
  height: auto;
  z-index: 2;
}

/* Fondo logo grande */
.seo-hero {
  background-image: url('paralelogo.png');
  background-repeat: no-repeat;
  background-position: center center;
  background-size: contain;
  opacity: 0;                 /* fade-in controlado por JS si quieres */
  transition: opacity 0.8s ease;
}

.seo-hero-content {
  max-width: 700px;
  margin: 0 auto;
  text-align: center;
  position: relative;
  z-index: 3;
}

.seo-hero-content h1 {
  font-size: clamp(2rem, 5vw, 3.5rem);
  margin-bottom: 1rem;
  color: #ffffff;
}

.seo-hero-content p {
  font-size: 1.1rem;
  line-height: 1.6;
  margin: 1.2rem auto;
  max-width: 60ch;
  color: #e0e0e0;
}

.seo-cta {
  display: inline-block;
  margin-top: 2rem;
  padding: 16px 32px;
  font-size: 1.2rem;
  font-weight: bold;
  color: #111;
  background: linear-gradient(135deg, #ffffff, #cfcfcf);
  border-radius: 8px;
  text-decoration: none;
  transition: transform 0.1s ease, box-shadow 0.1s ease;
}
.seo-cta:hover {
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 4px 14px rgba(255,255,255,0.35);
}

  </style>
  <script type="importmap">
{
  "imports": {
    "three": "https://cdn.jsdelivr.net/npm/three@0.165.0/build/three.module.js"
  }
}
</script>
<link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
<script type="module">
  import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.165.0/build/three.module.js';
  import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.165.0/examples/jsm/loaders/GLTFLoader.js';

  // -------------------------------------------------
  // ESCENA BÁSICA
  // -------------------------------------------------
  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0x111111); // gris muy oscuro, no negro puro

  // Cámara: más largo far plane porque viajamos bastante en -Z
  const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 500);
  camera.position.set(0, 2, 12); // arranque
  camera.lookAt(0, 2, 0);

  // Luz suave hemisférica (no crítica, pero ayuda a GLBs con materiales)
  const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1);
  light.position.set(0, 10, 0);
  scene.add(light);

  // Renderer
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  // -------------------------------------------------
  // PISO Y TECHO CUADRICULADOS
  // -------------------------------------------------
  const gridOpacity = 0.15;
  const gridSize = 500;
  const gridDivs = 100;

  const gridFloor = new THREE.GridHelper(gridSize, gridDivs, 0xffffff, 0xffffff);
  gridFloor.material.opacity = gridOpacity;
  gridFloor.material.transparent = true;
  scene.add(gridFloor);

  const gridCeiling = new THREE.GridHelper(gridSize, gridDivs, 0xffffff, 0xffffff);
  gridCeiling.material.opacity = gridOpacity;
  gridCeiling.material.transparent = true;
  gridCeiling.position.y = 4;        // altura del “techo”
  gridCeiling.rotation.x = Math.PI;  // voltear para que la cara visible mire hacia abajo
  scene.add(gridCeiling);

  // -------------------------------------------------
  // LOGO (PLANO CON TEXTURA PNG TRANSPARENTE)
  // -------------------------------------------------
  const textureLoader = new THREE.TextureLoader();
  const logoTexture = textureLoader.load('PARALEL2.png'); // asegúrate que exista
  const logoMaterial = new THREE.MeshBasicMaterial({ map: logoTexture, transparent: true });
  const logoMesh = new THREE.Mesh(new THREE.PlaneGeometry(10, 6), logoMaterial);
  logoMesh.position.set(0, 2, 0);
  scene.add(logoMesh);

  // -------------------------------------------------
  // CONFIG PANEL SCROLL
  // -------------------------------------------------
  // Datos: modelo GLB + texto
  const panelsData = [
    { model: 'EXP3.glb', text: 'Experiencia inmersiva' },
    { model: 'bus3.glb', text: 'Contenido personalizable' },
    { model: 'eco2.glb', text: 'Inversión a tu presupuesto' },
    { model: 'par2.glb', text: 'Entra al mundo paralelo' }
  ];

  // Espaciado entre paneles en -Z
  const panelSpacing = 15;     // distancia entre paneles
  const firstPanelZ = -15;     // Z del primero
  const panelY = 2;            // altura base panel
  const panelSideOffset = 2;   // +/- X alternado para darle ángulo

  // Control de enfoque y animaciones
  const rotStartDist = 20;   // empezar rotación cuando la cámara está más cerca que esto
  const rotMaxSpeed  = 0.02; // rotación máxima
  const lookAtLerp   = 0.08; // suavidad cámara hacia panel activo
  const camZLerp     = 0.08; // suavidad mov. en Z (ya lo usabas)
  const textFadeDist = 45;   // distancia a partir de la cual texto = 0

  // Loader de modelos
  const loader = new GLTFLoader();

  // Almacenamos referencias a cada panel
  const panels = [];

 // Crea texto Canvas -> textura con ajuste dinámico y fondo
function makeTextTexture(str) {
  const canvas = document.createElement('canvas');
  canvas.width = 512;
  canvas.height = 160;
  const ctx = canvas.getContext('2d');

  // Fondo negro semitransparente
  ctx.fillStyle = 'rgba(0,0,0,0.6)';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Ajuste de tamaño base
  let fontSize = 44;
  ctx.font = `bold ${fontSize}px Arial`;
  ctx.fillStyle = '#fff';
  ctx.textAlign = 'center';

  // Función para dividir texto
  function wrapText(text, x, y, maxWidth, lineHeight) {
    const words = text.split(' ');
    let line = '';
    for (let n = 0; n < words.length; n++) {
      const testLine = line + words[n] + ' ';
      const metrics = ctx.measureText(testLine);
      if (metrics.width > maxWidth && n > 0) {
        ctx.fillText(line, x, y);
        line = words[n] + ' ';
        y += lineHeight;
      } else {
        line = testLine;
      }
    }
    ctx.fillText(line, x, y);
  }

  // Centrado vertical básico
  const lineHeight = fontSize + 10;
  const startY = canvas.height / 2 - lineHeight / 2;

  wrapText(str, canvas.width / 2, startY, canvas.width - 40, lineHeight);

  return new THREE.CanvasTexture(canvas);
}

  function createPanel(panelInfo, i) {
    const group = new THREE.Group();

    // Texto (canvas → textura → plano)
    const textTexture = makeTextTexture(panelInfo.text);
    const textMaterial = new THREE.MeshBasicMaterial({ map: textTexture, transparent: true, opacity: 0 });
    const textMesh = new THREE.Mesh(new THREE.PlaneGeometry(4, 1), textMaterial);
    textMesh.position.set(0, -1, 0);
    group.add(textMesh);

    // Modelo 3D
    loader.load(panelInfo.model, (gltf) => {
      const model = gltf.scene;
      model.scale.set(1.5, 1.5, 1.5);
      model.position.y = 0;
      model.userData.rotate = true; // bandera: se puede rotar cuando esté cerca
      group.add(model);
    });

    // Posición alternando a izquierda/derecha
    const side = i % 2 === 0 ? -panelSideOffset : panelSideOffset;
    group.position.set(side, panelY, firstPanelZ - i * panelSpacing);

    // Inclinación leve hacia la cámara central
    group.rotation.y = side < 0 ? Math.PI / 8 : -Math.PI / 8;

    scene.add(group);
    panels.push({ group, textMaterial });
  }

  panelsData.forEach(createPanel);

  // -------------------------------------------------
  // SCROLL → progreso lineal [0..1]
  // -------------------------------------------------
  let scrollProgress = 0;
  window.addEventListener('scroll', () => {
    const maxScroll = document.body.scrollHeight - window.innerHeight;
    scrollProgress = maxScroll > 0 ? window.scrollY / maxScroll : 0;
  });

  // Rango total que recorre la cámara en Z
  const totalTravelZ = 100; // puedes ajustarlo; antes usabas ~100
  const camStartZ = 12;

  // Vector reutilizable para lerp de lookAt
  const camLookTarget = new THREE.Vector3();
  const currentLook = new THREE.Vector3(0, 2, 0); // arranque

  // -------------------------------------------------
  // ANIMACIÓN
  // -------------------------------------------------
  function animate() {
    requestAnimationFrame(animate);

    // Cámara avanza en Z según scroll
    const targetZ = camStartZ - scrollProgress * totalTravelZ;
    camera.position.z += (targetZ - camera.position.z) * camZLerp;

    // Determinar panel más cercano
    let closestPanel = null;
    let minDist = Infinity;
    panels.forEach(p => {
      const dz = camera.position.z - p.group.position.z;
      const dist = Math.abs(dz);
      if (dist < minDist) {
        minDist = dist;
        closestPanel = p;
      }
    });

const approachStart = 45;  // Empieza a mirar el panel desde esta distancia
const approachEnd = 5;     // Deja de mirar el panel cuando llega a esta distancia
const forwardLook = new THREE.Vector3(0, 2, -100);

if (closestPanel) {
  const panelZ = closestPanel.group.position.z;
  const dz = camera.position.z - panelZ; // Distancia cámara - panel

  let weight = 0; // 0 = mirar al frente, 1 = mirar al panel

  if (dz > approachEnd && dz < approachStart) {
    // Dentro del rango [approachStart → approachEnd]
    weight = THREE.MathUtils.clamp((dz - approachEnd) / (approachStart - approachEnd), 0, 1);
  } else if (dz <= approachEnd) {
    // Ya está muy cerca o lo pasó → mirar al frente
    weight = 0;
  }

  // Mezclar objetivo: panel vs adelante
  camLookTarget.copy(forwardLook).lerp(closestPanel.group.position, weight);
  camLookTarget.y += 0.5;

  currentLook.lerp(camLookTarget, lookAtLerp);
  camera.lookAt(currentLook);
}
    // Actualizar texto + rotaciones por distancia
    panels.forEach(p => {
      const dist = Math.abs(camera.position.z - p.group.position.z);

      // Texto: fade según distancia
      const opacity = THREE.MathUtils.clamp(1 - dist / textFadeDist, 0, 1);
      p.textMaterial.opacity = opacity;

      // Rotación: escala según cercanía
      const speedScale = THREE.MathUtils.clamp(1 - dist / rotStartDist, 0, 1);
      if (speedScale > 0) {
        p.group.children.forEach(child => {
          if (child.userData.rotate) child.rotation.y += rotMaxSpeed * speedScale;
        });
      }
    });

    renderer.render(scene, camera);
  }
  animate();
  // Referencias
const htmlSection = document.getElementById('html-section');
const canvas = renderer.domElement;

const htmlSection = document.getElementById('html-section');
const canvas = renderer.domElement;

renderer.domElement.classList.add('webgl-fade');
const fadeStartPercent = 90;  // empieza a desvanecer 3D
const fadeEndPercent   = 99;  // termina fade, aparece HTML
let threeVisible = true;      // control para pausar animación


function checkScrollTransition() {
  const maxScroll = document.body.scrollHeight - window.innerHeight;
  const scrollPercent = maxScroll > 0 ? (window.scrollY / maxScroll) * 100 : 0;

  // Normalizamos factor de fade 0..1 entre fadeStartPercent y fadeEndPercent
  let t = (scrollPercent - fadeStartPercent) / (fadeEndPercent - fadeStartPercent);
  t = Math.min(Math.max(t, 0), 1); // clamp

  // Opacidad escena 3D
  const sceneOpacity = 1 - t;

  // Canvas CSS
  canvas.style.opacity = sceneOpacity.toString();

  // Materiales de grillas
  gridFloor.material.opacity = gridOpacity * sceneOpacity;
  gridCeiling.material.opacity = gridOpacity * sceneOpacity;

  // Texturas de paneles
  panels.forEach(p => {
    p.textMaterial.opacity *= sceneOpacity; // multiplicativo suave
  });

  // Mostrar HTML cuando t está casi a 1
  if (t >= 1 && threeVisible) {
    threeVisible = false;
    htmlSection.style.display = 'block';
    // Pausar animación si quieres ahorro GPU:
    pause3D();
  } else if (t < 1 && !threeVisible) {
    threeVisible = true;
    htmlSection.style.display = 'none';
    resume3D();
  }
}
window.addEventListener('scroll', checkScrollTransition);

  // -------------------------------------------------
  // RESPONSIVE
  // -------------------------------------------------
  window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });
</script>
<div id="html-wrapper">
  <section id="html-section" class="seo-hero">
    <img src="paralelchico.png" alt="Paralel VR" class="seo-hero-logo">

    <div class="seo-hero-content">
      <h1>Realidad Virtual para Eventos en Perú</h1>
      <p>
        En <strong>PARALEL VR</strong> llevamos la <strong>realidad virtual en Perú</strong> a otro nivel. 
        Ofrecemos <strong>alquiler de VR para eventos en Lima y todo el país</strong>, 
        activaciones con <strong>Oculus Quest / Meta Quest</strong>, 
        experiencias inmersivas personalizadas para <strong>marcas, ferias, lanzamientos y activaciones BTL</strong>. 
        Si buscas <em>VR Perú</em>, <em>alquiler de gafas de realidad virtual</em> o 
        <em>servicio Oculus para eventos corporativos</em>, estás en el lugar correcto.
      </p>

      <p>
        Creamos <strong>experiencias interactivas 3D</strong>, juegos a medida, simuladores de producto, 
        recorridos virtuales, <strong>realidad aumentada + realidad virtual</strong>, 
        y escenografías digitales integradas con iluminación LED, sensores y control remoto. 
        ¿Necesitas una activación WOW que realmente atraiga público? Escríbenos.
      </p>

      <a href="mailto:ventas@paralelvr.pe" class="seo-cta">Cotiza tu evento VR</a>
    </div>
  </section>
</div>

</body>
</html>
